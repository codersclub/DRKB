---
Title: Работа через Handle
Author: 
Date: 01.01.2007
Keywords: 
Description: 
---

Работа через Handle
===================

::: {.date}
01.01.2007
:::

Еще один способ работы с файлами - это открытие Handle на файл и работу
через него. Тут есть 2 варианта - можно использовать функции Дельфи или
использовать WinAPI напрямую.

При использовании функций Дельфи можно применять следующие функции:

FileOpen(FileName, fmOpenWrite or fmShareDenyNone) - функция открывает
файл и возвращает целое цисло - Handle на файл. Параметры функции - имя
файла и тип доступа (все типы доступа я перечислил ранее). Если файл
успешно открыт то Handle должен быть положительным цислом, отрицательное
число - это код ошибки.

Во всех остальных функциях используется именно значение Handle,
возвращаемое этой функцией.

FileClose(Handle: Integer) - закрывает файл

FileRead(Handle: Integer; var Buffer; Count: Integer): Integer;

FileWrite(Handle: Integer; const Buffer; Count: Integer): Integer;

Эти функции для чтения/записи файла, где Buffer - любая переменная
достаточного размера для чтения/записи куска информации (обычно типа
PChar или массив), Count-количество байт, которое Вы желаете
записать/прочитать. Функции возвращают количество байт которые реально
были прочитанны или записаны.

Этот тип доступа к файлам применяется весьма редко. Дело в том что он
практически дублирует соответствующие функции WinAPI и к тому же обычно
работает несколько медленнее, чем например потоки. И все же
использование функций FileOpen и FileClose не лишено привлекательности.

Наряду с тем что эти функции намного легче в использовании
соответствующих функций WinAPI (можете сравнить - FileOpen имеет 2
параметра, cooтветствующая функция WinAPI - CreateFile имеет 7
параметров, большая часть из которых реально требуется лишь в
ограниченном числе случаев) этот путь доступа открывает возможность
прямого использования всех функций WinAPI про работе с файлами, которые
требуют Handle на открытый файл.

