---
Title: Реализация ADO в Delphi
Date: 01.01.2007
---


Реализация ADO в Delphi
=======================

Механизм доступа к данным через ADO и многочисленные объекты и
интерфейсы реализованы в VCL Delphi в виде набора компонентов,
расположенных на странице ADO. Все необходимые интерфейсы,
обеспечивающие работу компонентов, объявлены и описаны в файлах
OleDB.pas и ADODB.pas в папке \\Delphi7\\Source\\Vcl.

Компонент TADOConnection вобрал возможности перечислителя, источника
данных и сессии с возможностями обслуживания транзакций.

Текстовые команды ADO реализованы в компоненте TADOCommand.

Наборы рядов (нотация Microsoft) можно получить при помощи компонентов
TADOTable, TADOQuery, TADOstoredProc. Каждый из них реализует способ
доступа к конкретному типу представления данных в хранилище. Далее по
тексту, применительно к компонентам Delphi, совокупность возвращаемых из
хранилища данных строк будем называть набором записей, что соответствует
документации Inprise (см. www.borland.com или www.borland.ru) и стилю
изложения предыдущих глав.

Набор свойств и методов компонентов ADO обеспечивает реализацию всех
необходимых приложению БД функций. Способы использования компонентов ADO
немногим отличаются от стандартных компонентов VCL доступа к данным (см.
гл. 11).

Однако при необходимости разработчик может использовать все возможности
интерфейсов ADO, обращаясь к ним через соответствующие объекты ADO.

Компоненты доступа к данным ADO могут использовать два варианта
подключения к хранилищу данных. Это стандартный метод ADO и стандартный
метод Delphi.

В первом случае компоненты используют свойство connectionstring для
прямого обращения к хранилищу данных. Во втором случае используется
специальный компонент TADOConnection, который обеспечивает расширенное
управление соединением и позволяет обращаться к данным нескольким
компонентам одновременно.

Свойство connectionstring предназначено для хранения информации о
соединении с объектом ADO. В нем через точку с запятой перечисляются все
необходимые параметры. Как минимум, это должны быть имена провайдера
соединения или удаленного сервера:

    Connectionstring:='Remote Server=ServerName;Provider=ProviderName';

При необходимости указываются путь к удаленному провайдеру:

    Connectionstring:='Remote Provider=ProviderName';

и параметры, необходимые провайдеру:

    'User Name=User_Name;Password=Password';

Каждый компонент, обращающийся к хранилищу данных ADO самостоятельно,
задавая параметры соединения в свойстве Connectionstring, открывает
собственное соединение. Чем больше приложение содержит компонентов ADO,
тем больше соединений может быть открыто одновременно.

Поэтому целесообразно реализовать механизм соединения ADO через
специальный компонент - TADOConnection. Этот компонент открывает
соединение, также заданное свойством Connectionstring (см. выше), и
предоставляет разработчику дополнительные средства управления
соединением.

Компоненты, работающие с хранилищем данных ADO через данное соединение,
подключаются к компоненту TADOConnection при помощи свойства

    property Connection: TADOConnection;

которое имеет каждый компонент, инкапсулирующий набор данных ADO.
