---
Title: Соответствие стандарту ANSI SQL 92
Date: 01.01.2007
---


Соответствие стандарту ANSI SQL 92
==================================

::: {.date}
01.01.2007
:::

Соответствие стандарту ANSI SQL 92

В MS SQL Server имеются настройки, позволяющие изменять степень
соответствия сервера стандарту ANSI SQL 92.

SET ANSI\_NULLS {ON\|OFF} -- регулирует результат сравнения значений,
содержащих NULL. Если ANSI\_NULLS = OFF, то запрос

    SELECT * FROM MyTable WHERE MyField = NULL

Вернет все строки, в которых MyField установлено в NULL. Если
ANSI\_NULLS = OFF, то, в соответствии со стандартом ANSI SQL92 сравнение
с NULL возвращает UNKNOWN. Другие установки, на которые следует обратить
внимание:

SET CURSOR\_CLOSE\_ON\_COMMIT --- Устанавливает режим закрытия курсоров
по завершению транзакции      

SET ANSI\_NULL\_DFLT\_ON и  SET ANSI\_NULL\_DFLT\_OFF --- Устанавливают
nullability полей по умолчанию при создании таблицы      

SET IMPLICIT\_TRANSACTIONS --- Устанавливает режим Autocommit      

SET ANSI\_PADDING --- Устанавливает режим «отсечения» концевых пробелов
для вновь создаваемых полей      

SET QUOTED\_IDENTIFIER --- Разрешает выделение идентификаторов двойными
кавычками      

SET ANSI\_WARNINGS --- Устанавливает реакцию на математические ошибки  
   

Рассмотрение этих параметров выходит за рамки книги, однако необходимо
обратить на них внимание при чтении документации.

Установка SET ANSI\_DEFAULTS устанавливает режим максимальной
совместимости с ANSI SQL92. При установке SET ANSI\_DEFAULTS ON
устанавливаются в ON следующие параметры:

SET ANSI\_NULLS, SET CURSOR\_CLOSE\_ON\_COMMIT, SET
ANSI\_NULL\_DFLT\_ON, SET IMPLICIT\_TRANSACTIONS, SET ANSI\_PADDING, SET
QUOTED\_IDENTIFIER и SET ANSI\_WARNINGS

По умолчанию ANSI\_DEFAULTS = ON для клиентов ODBC и OLE DB (ADO) и OFF
для клиента DB-Library (BDE). Поскольку предпочтительным (и
поддерживаемым в будущем) методом доступа является OLE DB, то при
разработке клиентской части, использующей BDE, рекомендуется явно
устанавливать SET ANSI\_DEFAULTS ON. С разностью этой установки связана
и проблема, возникающая при разработке запросов при помощи Query
Analyzer. Если в нем и в клиентском приложении имеются разные настройки
совместимости с ANSI -- одни и те же запросы могут выдавать разные
результаты. Поэтому рекомендуется проверять настройки Query Analyzer на
предмет соответствия их тем, что предполагается иметь в клиенте.
