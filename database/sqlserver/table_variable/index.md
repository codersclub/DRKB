---
Title: Использование табличных переменных
Author: Vit
Date: 01.01.2007
---


Использование табличных переменных
==================================

::: {.date}
01.01.2007
:::

Табличные переменные объявляются очень похоже на запрос по созданию
таблиц и могут использоваться как обычные таблицы

    Declare @MyMemoryTable Table (id int, Field1 varchar(30))
     
    Insert into @MyMemoryTable
    Select ID, Field1 From MyTable Where Field2=0
     
    Select * From @MyMemoryTable

Примечания:

1. Табличные переменные чрезвычайно эффективны как временное хранилище
данных небольшого размера, они более эффективны чем временные таблицы.
Следует их использовать везде где только можно вместо временных таблиц

2. Не следует использовать табличные переменные при количестве записей
больше нескольких тысяч

3. Табличные переменные нельзя передавать как параметры в процедуры и
функции

4. Табличные переменные не поддерживают вставку из Select ... Into...
Следующий код работать не будет:

    Select * into @MyTempTable From MyTable

Автор: Vit
