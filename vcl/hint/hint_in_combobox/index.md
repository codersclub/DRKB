---
Title: Hint в выпадающем списке ComboBox
Date: 01.01.2007
---


Hint в выпадающем списке ComboBox
=================================

::: {.date}
01.01.2007
:::

В практике программирования довольно часто встречается ситуация когда
информация, предназначенная для отображения в имеющемся компоненте, не
помещается по длине. С подобным обычно сталкиваются в работе с базами
данных. В таких случая выручают всплывающие подсказки -- Hint. Но, в
некоторых случаях, даже такая возможность не спасает. К таким ситуациям
можно отнести работу с выпадающим списком в DBComboBox. Представьте, что
размер поля увеличился, а изменить ширину DBComboBox на форме, по тем
или иным причинам, нет возможности. Конечно, можно увеличить ширину
выпадающего списка. Но выглядит это не всегда красиво да и не делает
чести разработчику. Предлагаемая идея позволит создать более изящный
компонент. Взгляните на рисунок:

В демонстрационном примере в выпадающем списке появляется всплывающая
подсказка для строки не помещающейся по длине.

При работе с Hint нужно помнить -- использовать ToolTip из API,
бесполезная затея. Delphi игнорирует любые попытки работы ним. Для этих
целей в Delphi предусмотрен класс -- THintWindow.

В своем компоненте объявите FTipHint:

    type
    TVSComboBox = class(TCustomComboBox)
    …
    private
    FHint: THintWindow;
    …
    protected
    procedure WMCTLCOLORLISTBOX(var Message: TMessage);
    message WM_CTLCOLORLISTBOX;

и не забудьте выполнить инициализацию в конструкторе вашего компонента:

    begin
    inherited Create(AOwner);
    FHint := THintWindow.Create(Self);

Чтобы получить информацию об активной строке в выпадающем списке
ComboBox перехватите сообщение WM\_CTLCOLORLISTBOX. В процедуре
сообщения анализируйте - если длина строки больше ширины выпадающего
списка -- передайте "длинную" строку в ваш Hint и активируйте его:

    FHint.ActivateHint(TextRC, Items[ItemIndex]);

где

TextRC -- прямоугольник для строки подсказки

Items[ItemIndex] -- "длинная" строка из выпадающего списка

Если активная строка в выпадающем списке "короткая" -- спрячьте Hint:

    FHint.ReleaseHandle;

Для получения подробной информации о классе THintWindow воспользуйтесь
Help из Delphi.
