---
Title: Поиск значения при вводе
Author: Bob
Date: 01.01.2007
---


Поиск значения при вводе
========================

::: {.date}
01.01.2007
:::

Каким способом можно производить поиск подходящих величин в момент
ввода? Табличный курсор (визуально) должен перемещаться к наиболее
подходящему значению при добавлении пользователем новых символов водимой
величины.

Первоначально код писался под Delphi 1. Это может и не лучшее решение,
но это работает.

Для поиска величины таблица держится открытой. Индекс должен,
естественно, принадлежать полю, используемому элементом управления
EditBox. В случае изменения содержимого EditBox, новое значение
используется для вызова стандартной функции FindNearest таблицы TTable.
Возвращаемая величина снова присваивается свойcтву Text элемента
EditBox.

Я привел лишь общее решение задачи. Фактически во время изменения
значения я включал таймер на период 1/3 секунды и в обработчике события
OnTimer проводил операцию поиска (с выключением таймера). Это позволяло
пользователю набирать без задержки нужный текст без необходимости
производить поиск в расчете на вновь введенный символ (поиск проводился
только при возникновении задержки в 1/3 секунды).

Вам также может понадобиться специальный обработчик нажатия клавиши
backspace или добавления символа в любое место строки.

Вместо возвращения результатов элементу EditBox (который перезаписывает
введенное пользователем значение), вы можете передавать результаты
другому элементу управления, например компоненту ListBox. Вы также
можете отобразить несколько наиболее подходящих значений, к примеру так:

    procedure Edit1OnChange(...);
    var
      i: integer;
    begin
      if not updating then
        exit;
      {сделайте обновление где-нибудь еще -
      например при срабатывании таймера}
      updating := false;
      Table1.FindNearest([Edit1.text]);
      ListBox1.clear;
      i := 0;
      while (i < 5) and (not (table1.eof)) do
      begin
        listbox.items.add(Table1.fields[0].asString);
        inc(i);
        table1.next;
      end;
      listbox1.itemindex := 0;
    end;

Автор: Bob

Взято с <https://delphiworld.narod.ru>

------------------------------------------------------------------------

Каким способом можно производить поиск подходящих величин в момент
ввода? Табличный курсор (визуально) должен перемещаться к наиболее
подходящему значению при добавлении пользователем новых символов водимой
величины.

Это просто. Вот что я написал в обработчике события OnChange редактора.

    with MainForm.PatientTable do
    begin
      { начинаем поиск имени }
      IndexName := 'Name';
      FindNearest([SearchFor.Text]);
    end;

Код подразумевает, что имя индекса, по которому производится поиск -
Name. Свяжите этот код с табличной сеткой и курсор будет перескакивать
на ближайшую запись, удовлетворяющую введенной пользователем информации.

Взято с <https://delphiworld.narod.ru>
