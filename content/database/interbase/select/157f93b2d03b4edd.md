Почему таблица или select показывается в Grid быстро, а перемещение в конец таблицы происходит долго?
=====================================================================================================

::: {.date}
01.01.2007
:::

Когда вы открываете набор данных при помощи TTable, BDE производит fetch
только такого количества записей, которые помещаются в Grid. Если вы
захотели переместиться в конец таблицы, то для большинства SQL-серверов
возможно перемещение по записям только вперед - т.е. если вам
потребуется поместить указатель в середину таблицы то BDE пришлось-бы
заново перечитывать записи с ее начала. Причина такой работы в том, что
SQL-серверы в большинстве возвращают результаты запросов в виде
последовательных наборов записей. В навигационных БД напротив, возможно
физическое позиционирование на любую запись таблицы.

Если SQL-сервер поддерживает двунаправленные скроллируемые курсоры, то
полное кэширование записей запроса выполняться BDE не будет.

Кроме этого, TTable и TQuery работают по разному. TQuery при перемещении
в конец таблицы действительно сделает выборку всех записей, т.к. он и не
может иначе - для выполнения задано конкретное SQL-выражение.

TTable-же напротив, показывает всю таблицу, и запросы для получения
содержимого таблицы формируются автоматически. Поэтому TTable при
нажатии вами в TDBGrid клавиш Ctrl-End сформирует запрос типа

    SELECT * FROM TABLE ORDER BY INDEXFIELD DESC 

и покажет только видимые в DBGrid записи \"с конца\". При этом, если нет
DESC индекса по полю INDEXFIELD, сортировка данных (ORDER BY) будет
производиться на диске. И чем больше записей в таблице, тем дольше. Для
того, чтобы перемещение по Ctrl-End для TTable происходило быстро, нужно
создать DESC индекс по полю сортировки. В этом случае операцию перехода
в конец таблицы TTable выполнит практически мгновенно. Пользователи
Delphi C/S могут посмотреть операторы, выдаваемые TTable SQL-серверу при
помощи SQL Monitor.

Более подробно на эту тему см. документ
http://www.ibase.ru/devinfo/bde.htm

Автор: [Дмитрий Кузьменко](mailto:delphi@demo.ru)
(<https://www.ibase.ru>)
