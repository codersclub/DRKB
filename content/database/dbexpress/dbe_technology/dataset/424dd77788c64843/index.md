---
Title: TSQLStoredProc
Date: 01.01.2007
---


TSQLStoredProc
==============

::: {.date}
01.01.2007
:::

Компонент TSQLStoredProc инкапсулирует функциональность хранимых
процедур для их выполнения в рамках технологии dbExpress. Он подобен
другим своим аналогам. Подробнее о функциях компонентов хранимых
процедур см. часть III. Имя хранимой процедуры определяется свойством

property StoredProcName: string;

Для работы с входными и выходными параметрами предназначено свойство

property Params: TParams;

Внимание

При работе с параметрами желательно использовать обращение к конкретному
параметру по имени при помощи метода ParamByName. При работе с
некоторыми серверами порядок следования параметров до выполнения
процедуры и после может изменяться.

Процедура выполняется методом

function ExecProc: Integer; virtual;

если она не возвращает набор данных. Иначе используются свойство Active
или метод open.

Если хранимая процедура возвращает несколько связанных наборов данных
(подобно иерархическим запросам ADO), доступ к следующему набору данных
осуществляет метод

function NextRecordSet: TCustomSQLDataSet;

автоматически создавая объект типа TCustomSQLDataSet для инкапсуляции
новых данных. Возврат к предыдущему набору данных возможен, если вы
определили объектные переменные для каждого набора данных:

    var SecondSet: TCustomSQLDataSet; 
     
    MyProc.Open; 
    while Not MyProc.Eof do 
      begin 
        {...} 
        Next; 
      end; 
    SecondSet := MyProc.NextRecordSet;  
    SecondSet.Open; {...} 
    SecondSet.Close;  
    MyProc.Close; 
