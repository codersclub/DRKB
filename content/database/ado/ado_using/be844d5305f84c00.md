Объект ошибок ADO
=================

::: {.date}
01.01.2007
:::

При рассказе о компонентах ADO в данной главе мы довольно часто
упоминали об объектах ошибок ADO. Эти объекты содержат информацию об
ошибке, возникшей при выполнении операции каким-либо объектом ADO.

В Delphi для объекта ошибки не предусмотрен специальный тип, но
разработчик может использовать его методы интерфейса Error,
предоставляемого многими методами других объектов ADO. Например, тип

TRecordsetEvent = procedure(DataSet: TCustomADODataSet; const Error:
Error;

var EventStatus: TEventStatus) of object;

используемый для метода-обработчика, вызываемого после обновления набора
данных, содержит параметр Error, дающий нам искомую ссылку.

Рассмотрим полезные свойства объекта ошибок ADO.

Свойство

property Description: WideString read Get\_Description;

возвращает описание ошибки, переданное из объекта, в котором ошибка
произошла.

Свойство

property SQLState: WideString read Get\_SQLState;

содержит текст команды, вызвавшей ошибку. Свойство

property NativeError: Integer read Get\_NativeError;

возвращает код ошибки, переданный из объекта, в котором ошибка
произошла.
