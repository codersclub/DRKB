TObject
=======

::: {.date}
01.01.2007
:::

Класс TObject

Класс TObject является родоначальником всей иерархии использующихся в
Delphi классов VCL. Он реализует функции, которые обязательно будет
выполнять любой объект, который может быть создан в среде разработки.
Учитывая гигантское разнообразие возможных областей применения объектов
в процессе создания приложений, можно сказать, что круг общих для всех
классов операций весьма невелик.

В первую очередь --- это создание экземпляра объекта и его уничтожение.
Любой объект выполняет эти две операции в обязательном порядке. Процесс
создания объекта включает выделение области адресного пространства,
установку указателя на экземпляр объекта, задание начальных значений
свойств и выполнение установочных действий, связанных с назначением
объекта. В общем случае две последние операции могут не выполняться.

Указатель на экземпляр объекта передается в переменную объектного типа,
которая в дальнейшем будет идентифицировать объект в программном коде
приложения. В приведенном выше фрагменте кода переменная объектного типа
someList объявлена как экземпляр типа TStrings. При создании экземпляра
этого типа конструктор Create возвращает в переменную SomeList указатель
на выделенную для нового объекта область памяти. Для этого применяется
метод Newinstance, который вызывается в конструкторе автоматически:

    class function Newinstance: TObject; virtual; 

Объект класса TObject обеспечивает выполнение этого процесса для любого
порожденного от него объекта. А уже внутри конструктора, который
унаследован от класса TObject, можно предусмотреть инициализацию
переменных и выполнение дополнительных операций. Объявление конструктора
выглядит следующим образом:

    constructor Create; 

В конструкторах потомков это объявление может перекрываться, но при
необходимости вызвать конструктор предка используется оператор
inherited:

    constructor TSomeObject.Create;  
    begin  
    inherited Create; 
    ... 
    end; 

Для уничтожения экземпляра объекта в классе TObject предназначены методы
Destroy и Free:

    destructor Destroy; virtual;  
    procedure Free;

Как видно из объявления, настоящим деструктором является метод Destroy.
Он обеспечивает освобождение всех занимаемых экземпляром объекта
ресурсов. Обычно при создании новых классов деструктор всегда
перекрывается для того, чтобы корректно завершить работу с данными.

Примечание

Обратите внимание, что обычно унаследованный конструктор вызывается в
первую очередь. Это необходимо для того, чтобы выполнить все нужные
операции при создании объекта до инициализации его собственных свойств.
При уничтожении объекта обычно сначала выполняются завершающие операции
и только в самом конце вызывается унаследованный деструктор, чтобы
выполнить собственно уничтожение объекта.

При уничтожении объектов рекомендуется вместо деструктора использовать
метод Free, который просто вызывает деструктор, но перед этим проверяет,
чтобы указатель на экземпляр объекта был не пустым (не был равен Nil).
Это позволяет избежать серьезных ошибок.

Если объект является владельцем других объектов (например, форма владеет
всеми размещенными на ней компонентами), то его метод Free автоматически
вызовет эти же методы для всех объектов. Поэтому при закрытии формы
разработчик избавлен от необходимости заботиться об уничтожении всех
компонентов.

Для освобождения занимаемой объектом памяти деструктор автоматически
Вызывает метод Freelnstance:

    procedure Freelnstance; virtual; 

Каждый объект должен содержать некоторую информацию о себе, которая
используется приложением и средой разработки. Поэтому класс TObject
содержит ряд методов, обеспечивающих представление этой информации в
потомках.

    class function Classlnfo: Pointer; 

возвращает указатель на таблицу информации времени выполнения (RTTI).
Эта информация используется в среде разработки и в приложении.

    class function ClassName: ShortString; 

возвращает имя типа объекта, которое может быть использовано для
идентификации. Например, один метод-обработчик щелчка на кнопке может
работать с несколькими типами компонентов кнопок:

    procedure TForml.BitBtnlClick(Sender: TObject); 
    begin  
      if Sender is TBitBtn then TBitBtn(Sender).Enabled := False; 
      if Sender is TSpeedButton then TSpeedButton(Sender).Down := True; 
    end; 

Метод

    class function ClassNamels(const Name: string): Boolean; 

позволяет определить, является ли данный объект того типа, имя которого
передано в параметре Name. В случае положительного ответа функция
возвращает True.

Как известно, программирование для Windows основано на событиях. Каждое
приложение и каждый программный объект должны уметь реагировать на
сообщение о событиях и, в свою очередь, рассылать сообщения. В
выполнении этих операций заключается третья общая для всех объектов
функция.

Метод

    procedure Dispatch(var Message); virtual; 

осуществляет обработку сообщений, поступающих объекту. Он определяет,
сможет ли объект обработать сообщение при помощи собственных
обработчиков событий. В случае отсутствия таких методов сообщение
передается аналогичному методу Dispatch класса-предка (если он есть).

Класс TObject имеет предопределенный обработчик событий:

    procedure DefaultHandler(var Message); virtual; 

Кроме рассмотренных здесь методов, класс TObject имеет еще несколько
методов, которые в основном применяются для взаимодействия объекта со
средой разработки.

В целом класс TObject может служить для создания на его основе некоторых
простых классов для использования в приложениях.
